<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Laboratorio: ETL con Pentaho - Sesion 06</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body { font-family: 'Segoe UI', system-ui, sans-serif; }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-100 to-slate-200 min-h-screen">
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        function App() {
            const [currentStep, setCurrentStep] = useState(0);
            const [completedSteps, setCompletedSteps] = useState([]);

            const labSteps = [
                {
                    title: 'Preparar el Entorno',
                    duration: '15 min',
                    icon: 'üîß',
                    content: `
                        <div class="space-y-4">
                            <div class="bg-cyan-50 border-l-4 border-cyan-500 p-4">
                                <h4 class="font-bold text-cyan-800">Objetivo</h4>
                                <p class="text-gray-700">Instalar y configurar Pentaho Data Integration (PDI) Community Edition.</p>
                            </div>

                            <h4 class="font-bold text-lg">Paso 1: Descargar Pentaho</h4>
                            <ol class="list-decimal list-inside space-y-2 text-gray-700">
                                <li>Ve a <a href="https://www.hitachivantara.com/en-us/products/pentaho-plus-platform/data-integration-analytics/pentaho-community-edition.html" target="_blank" class="text-cyan-600 hover:underline">Pentaho Community Edition</a></li>
                                <li>Descarga "Pentaho Data Integration" (pdi-ce-X.X.X.zip)</li>
                                <li>Descomprime en una carpeta (ej: C:\\pentaho o /opt/pentaho)</li>
                            </ol>

                            <h4 class="font-bold text-lg mt-4">Paso 2: Requisitos</h4>
                            <div class="bg-gray-100 p-4 rounded-lg">
                                <ul class="space-y-1 text-sm">
                                    <li>‚Ä¢ Java JDK 8 o superior instalado</li>
                                    <li>‚Ä¢ Variable JAVA_HOME configurada</li>
                                    <li>‚Ä¢ Al menos 4GB de RAM disponibles</li>
                                </ul>
                            </div>

                            <h4 class="font-bold text-lg mt-4">Paso 3: Iniciar Spoon</h4>
                            <div class="bg-gray-800 text-green-400 p-4 rounded-lg font-mono text-sm">
                                <div class="text-gray-500"># Windows</div>
                                <div>cd C:\\pentaho\\data-integration</div>
                                <div>Spoon.bat</div>
                                <div class="text-gray-500 mt-3"># Linux/Mac</div>
                                <div>cd /opt/pentaho/data-integration</div>
                                <div>./spoon.sh</div>
                            </div>

                            <div class="bg-amber-50 border border-amber-200 p-4 rounded-lg mt-4">
                                <h4 class="font-bold text-amber-800">Alternativa: Google Colab + Python</h4>
                                <p class="text-sm text-gray-700">
                                    Si no puedes instalar Pentaho, simularemos el ETL con pandas en un notebook.
                                    El proceso logico es identico; solo cambia la herramienta.
                                </p>
                            </div>
                        </div>
                    `
                },
                {
                    title: 'Crear Archivos Fuente',
                    duration: '10 min',
                    icon: 'üìÑ',
                    content: `
                        <div class="space-y-4">
                            <div class="bg-cyan-50 border-l-4 border-cyan-500 p-4">
                                <h4 class="font-bold text-cyan-800">Caso: FarmaciaSalud Panama</h4>
                                <p class="text-gray-700">
                                    Cadena de farmacias que necesita consolidar ventas de 3 sucursales.
                                    Cada sucursal genera un CSV diario con formato diferente.
                                </p>
                            </div>

                            <h4 class="font-bold text-lg">Archivo 1: ventas_sucursal_a.csv</h4>
                            <div class="bg-gray-800 text-gray-100 p-4 rounded-lg font-mono text-xs overflow-x-auto">
<pre>fecha,codigo_prod,nombre_producto,cantidad,precio_unit,total
2026-02-01,MED001,Acetaminofen 500mg,15,2.50,37.50
2026-02-01,MED002,Ibuprofeno 400mg,8,3.25,26.00
2026-02-01,VIT001,Vitamina C 1000mg,20,5.00,100.00
2026-02-02,MED001,Acetaminofen 500mg,12,2.50,30.00
2026-02-02,MED003,Omeprazol 20mg,5,8.50,42.50</pre>
                            </div>

                            <h4 class="font-bold text-lg mt-4">Archivo 2: ventas_sucursal_b.csv</h4>
                            <div class="bg-gray-800 text-gray-100 p-4 rounded-lg font-mono text-xs overflow-x-auto">
<pre>FECHA_VENTA;COD_PRODUCTO;DESCRIPCION;QTY;PRECIO;SUBTOTAL
01/02/2026;MED001;ACETAMINOFEN 500MG;10;2.50;25.00
01/02/2026;MED004;LORATADINA 10MG;6;4.00;24.00
02/02/2026;VIT001;VITAMINA C 1000MG;15;5.00;75.00
02/02/2026;MED002;IBUPROFENO 400MG;20;3.25;65.00</pre>
                            </div>

                            <h4 class="font-bold text-lg mt-4">Archivo 3: ventas_sucursal_c.csv</h4>
                            <div class="bg-gray-800 text-gray-100 p-4 rounded-lg font-mono text-xs overflow-x-auto">
<pre>date|product_code|product_name|qty|unit_price|line_total
2026-02-01|MED003|Omeprazol 20mg|8|8.50|68.00
2026-02-01|MED005|Metformina 850mg|25|3.00|75.00
2026-02-02|MED001|Acetaminofen 500mg|18|2.50|45.00
2026-02-02|VIT002|Vitamina D3 1000UI|10|7.50|75.00</pre>
                            </div>

                            <div class="bg-rose-50 border border-rose-200 p-4 rounded-lg mt-4">
                                <h4 class="font-bold text-rose-800">Problemas a Resolver</h4>
                                <ul class="text-sm text-gray-700 space-y-1 mt-2">
                                    <li>‚ùå Diferentes delimitadores (coma, punto y coma, pipe)</li>
                                    <li>‚ùå Diferentes formatos de fecha (YYYY-MM-DD vs DD/MM/YYYY)</li>
                                    <li>‚ùå Diferentes nombres de columnas</li>
                                    <li>‚ùå Mayusculas vs minusculas en nombres</li>
                                </ul>
                            </div>

                            <p class="text-gray-600 mt-4">
                                <strong>Instruccion:</strong> Crea estos 3 archivos CSV en una carpeta llamada <code class="bg-gray-200 px-1 rounded">data_source</code>.
                            </p>
                        </div>
                    `
                },
                {
                    title: 'Crear Transformacion: Leer Fuentes',
                    duration: '20 min',
                    icon: 'üì•',
                    content: `
                        <div class="space-y-4">
                            <div class="bg-cyan-50 border-l-4 border-cyan-500 p-4">
                                <h4 class="font-bold text-cyan-800">Objetivo</h4>
                                <p class="text-gray-700">Crear una transformacion que lea los 3 archivos CSV con sus diferentes formatos.</p>
                            </div>

                            <h4 class="font-bold text-lg">Paso 1: Nueva Transformacion</h4>
                            <ol class="list-decimal list-inside space-y-2 text-gray-700">
                                <li>En Spoon: File ‚Üí New ‚Üí Transformation</li>
                                <li>Guarda como: <code class="bg-gray-200 px-1 rounded">tr_farmacia_ventas.ktr</code></li>
                            </ol>

                            <h4 class="font-bold text-lg mt-4">Paso 2: Agregar CSV Input para Sucursal A</h4>
                            <ol class="list-decimal list-inside space-y-2 text-gray-700">
                                <li>Desde el panel Design, arrastra "CSV file input"</li>
                                <li>Doble clic para configurar:</li>
                            </ol>
                            <div class="bg-gray-100 p-4 rounded-lg mt-2 text-sm">
                                <table class="w-full">
                                    <tr><td class="font-medium w-1/3">Step name:</td><td>Leer Sucursal A</td></tr>
                                    <tr><td class="font-medium">Filename:</td><td>data_source/ventas_sucursal_a.csv</td></tr>
                                    <tr><td class="font-medium">Delimiter:</td><td>,</td></tr>
                                    <tr><td class="font-medium">Enclosure:</td><td>"</td></tr>
                                </table>
                            </div>
                            <p class="text-sm text-gray-600 mt-2">
                                Haz clic en "Get Fields" para detectar las columnas automaticamente.
                            </p>

                            <h4 class="font-bold text-lg mt-4">Paso 3: Agregar CSV Input para Sucursal B</h4>
                            <div class="bg-gray-100 p-4 rounded-lg mt-2 text-sm">
                                <table class="w-full">
                                    <tr><td class="font-medium w-1/3">Step name:</td><td>Leer Sucursal B</td></tr>
                                    <tr><td class="font-medium">Filename:</td><td>data_source/ventas_sucursal_b.csv</td></tr>
                                    <tr><td class="font-medium">Delimiter:</td><td>;</td></tr>
                                </table>
                            </div>

                            <h4 class="font-bold text-lg mt-4">Paso 4: Agregar CSV Input para Sucursal C</h4>
                            <div class="bg-gray-100 p-4 rounded-lg mt-2 text-sm">
                                <table class="w-full">
                                    <tr><td class="font-medium w-1/3">Step name:</td><td>Leer Sucursal C</td></tr>
                                    <tr><td class="font-medium">Filename:</td><td>data_source/ventas_sucursal_c.csv</td></tr>
                                    <tr><td class="font-medium">Delimiter:</td><td>|</td></tr>
                                </table>
                            </div>

                            <div class="bg-green-50 border border-green-200 p-4 rounded-lg mt-4">
                                <h4 class="font-bold text-green-800">Tip: Preview</h4>
                                <p class="text-sm text-gray-700">
                                    Haz clic derecho en cada paso y selecciona "Preview" para verificar que los datos se leen correctamente.
                                </p>
                            </div>
                        </div>
                    `
                },
                {
                    title: 'Estandarizar y Transformar',
                    duration: '25 min',
                    icon: '‚öôÔ∏è',
                    content: `
                        <div class="space-y-4">
                            <div class="bg-cyan-50 border-l-4 border-cyan-500 p-4">
                                <h4 class="font-bold text-cyan-800">Objetivo</h4>
                                <p class="text-gray-700">Normalizar los datos de las 3 sucursales a un formato comun.</p>
                            </div>

                            <h4 class="font-bold text-lg">Paso 1: Select Values para Estandarizar Nombres</h4>
                            <p class="text-gray-700">Para cada sucursal, agrega un paso "Select values" que renombre las columnas:</p>

                            <div class="bg-gray-100 p-4 rounded-lg mt-2 text-sm">
                                <h5 class="font-bold mb-2">Sucursal A ‚Üí Select Values A</h5>
                                <table class="w-full text-xs">
                                    <thead class="bg-gray-200">
                                        <tr><th>Original</th><th>Nuevo Nombre</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr><td>fecha</td><td>fecha_venta</td></tr>
                                        <tr><td>codigo_prod</td><td>codigo_producto</td></tr>
                                        <tr><td>nombre_producto</td><td>nombre_producto</td></tr>
                                        <tr><td>cantidad</td><td>cantidad</td></tr>
                                        <tr><td>precio_unit</td><td>precio_unitario</td></tr>
                                        <tr><td>total</td><td>total_linea</td></tr>
                                    </tbody>
                                </table>
                                <p class="mt-2 text-gray-600">Agregar campo constante: sucursal = 'A'</p>
                            </div>

                            <div class="bg-gray-100 p-4 rounded-lg mt-4 text-sm">
                                <h5 class="font-bold mb-2">Sucursal B ‚Üí Select Values B</h5>
                                <table class="w-full text-xs">
                                    <thead class="bg-gray-200">
                                        <tr><th>Original</th><th>Nuevo Nombre</th></tr>
                                    </thead>
                                    <tbody>
                                        <tr><td>FECHA_VENTA</td><td>fecha_venta</td></tr>
                                        <tr><td>COD_PRODUCTO</td><td>codigo_producto</td></tr>
                                        <tr><td>DESCRIPCION</td><td>nombre_producto</td></tr>
                                        <tr><td>QTY</td><td>cantidad</td></tr>
                                        <tr><td>PRECIO</td><td>precio_unitario</td></tr>
                                        <tr><td>SUBTOTAL</td><td>total_linea</td></tr>
                                    </tbody>
                                </table>
                                <p class="mt-2 text-gray-600">Agregar campo constante: sucursal = 'B'</p>
                            </div>

                            <h4 class="font-bold text-lg mt-4">Paso 2: Convertir Fechas</h4>
                            <p class="text-gray-700">Para Sucursal B que tiene formato DD/MM/YYYY:</p>
                            <ol class="list-decimal list-inside space-y-1 text-gray-700 text-sm">
                                <li>Agrega paso "Select values" despues del renombre</li>
                                <li>En la pestana "Meta-data", cambia el tipo de fecha_venta</li>
                                <li>Format: dd/MM/yyyy ‚Üí Conversion: Date</li>
                            </ol>

                            <h4 class="font-bold text-lg mt-4">Paso 3: Normalizar Mayusculas</h4>
                            <p class="text-gray-700">Para Sucursal B que tiene nombres en mayusculas:</p>
                            <ol class="list-decimal list-inside space-y-1 text-gray-700 text-sm">
                                <li>Agrega paso "String operations"</li>
                                <li>Campo: nombre_producto</li>
                                <li>Operacion: Init Cap (primera letra mayuscula)</li>
                            </ol>

                            <div class="bg-amber-50 border border-amber-200 p-4 rounded-lg mt-4">
                                <h4 class="font-bold text-amber-800">Agregar Constante: Sucursal</h4>
                                <p class="text-sm text-gray-700">
                                    Usa el paso "Add constants" para agregar el identificador de sucursal ('A', 'B', 'C')
                                    a cada flujo antes de unirlos.
                                </p>
                            </div>
                        </div>
                    `
                },
                {
                    title: 'Unir Flujos y Cargar',
                    duration: '20 min',
                    icon: 'üîó',
                    content: `
                        <div class="space-y-4">
                            <div class="bg-cyan-50 border-l-4 border-cyan-500 p-4">
                                <h4 class="font-bold text-cyan-800">Objetivo</h4>
                                <p class="text-gray-700">Combinar los 3 flujos en uno solo y cargar en una tabla de staging.</p>
                            </div>

                            <h4 class="font-bold text-lg">Paso 1: Append Streams</h4>
                            <ol class="list-decimal list-inside space-y-2 text-gray-700">
                                <li>Arrastra el paso "Append streams" al canvas</li>
                                <li>Conecta los 3 flujos (Select Values A, B, C) a este paso</li>
                                <li>Este paso une verticalmente los datos (UNION ALL)</li>
                            </ol>

                            <div class="bg-gray-100 p-4 rounded-lg mt-2">
                                <h5 class="font-bold mb-2">Esquema Visual</h5>
                                <div class="flex flex-col items-center gap-2 text-sm">
                                    <div class="flex gap-4">
                                        <div class="bg-blue-100 px-3 py-1 rounded">Sucursal A</div>
                                        <div class="bg-blue-100 px-3 py-1 rounded">Sucursal B</div>
                                        <div class="bg-blue-100 px-3 py-1 rounded">Sucursal C</div>
                                    </div>
                                    <div>‚Üì ‚Üì ‚Üì</div>
                                    <div class="bg-amber-100 px-4 py-2 rounded font-bold">Append Streams</div>
                                    <div>‚Üì</div>
                                    <div class="bg-green-100 px-4 py-2 rounded font-bold">Table Output</div>
                                </div>
                            </div>

                            <h4 class="font-bold text-lg mt-4">Paso 2: Table Output</h4>
                            <p class="text-gray-700">Configura la salida a la base de datos:</p>

                            <div class="bg-gray-100 p-4 rounded-lg mt-2 text-sm">
                                <table class="w-full">
                                    <tr><td class="font-medium w-1/3">Connection:</td><td>Tu conexion Supabase/PostgreSQL</td></tr>
                                    <tr><td class="font-medium">Target schema:</td><td>staging</td></tr>
                                    <tr><td class="font-medium">Target table:</td><td>stg_ventas_farmacia</td></tr>
                                    <tr><td class="font-medium">Truncate table:</td><td>‚úì (para cargas full)</td></tr>
                                </table>
                            </div>

                            <h4 class="font-bold text-lg mt-4">Paso 3: Crear Tabla Destino</h4>
                            <div class="bg-gray-800 text-green-400 p-4 rounded-lg font-mono text-sm overflow-x-auto">
<pre>CREATE SCHEMA IF NOT EXISTS staging;

CREATE TABLE staging.stg_ventas_farmacia (
    id SERIAL PRIMARY KEY,
    fecha_venta DATE,
    codigo_producto VARCHAR(20),
    nombre_producto VARCHAR(100),
    cantidad INT,
    precio_unitario DECIMAL(10,2),
    total_linea DECIMAL(10,2),
    sucursal CHAR(1),
    fecha_carga TIMESTAMP DEFAULT NOW()
);</pre>
                            </div>

                            <h4 class="font-bold text-lg mt-4">Paso 4: Configurar Conexion</h4>
                            <ol class="list-decimal list-inside space-y-2 text-gray-700 text-sm">
                                <li>View ‚Üí Database Connections</li>
                                <li>New ‚Üí PostgreSQL</li>
                                <li>Ingresa los datos de tu Supabase (host, puerto, usuario, password)</li>
                                <li>Test para verificar conexion</li>
                            </ol>

                            <div class="bg-green-50 border border-green-200 p-4 rounded-lg mt-4">
                                <h4 class="font-bold text-green-800">Ejecutar</h4>
                                <p class="text-sm text-gray-700">
                                    Haz clic en el boton Run (triangulo verde) o presiona F9 para ejecutar la transformacion.
                                </p>
                            </div>
                        </div>
                    `
                },
                {
                    title: 'Crear Job de Orquestacion',
                    duration: '15 min',
                    icon: 'üìã',
                    content: `
                        <div class="space-y-4">
                            <div class="bg-cyan-50 border-l-4 border-cyan-500 p-4">
                                <h4 class="font-bold text-cyan-800">Objetivo</h4>
                                <p class="text-gray-700">Crear un Job que ejecute la transformacion con manejo de errores y notificacion.</p>
                            </div>

                            <h4 class="font-bold text-lg">Paso 1: Nuevo Job</h4>
                            <ol class="list-decimal list-inside space-y-2 text-gray-700">
                                <li>File ‚Üí New ‚Üí Job</li>
                                <li>Guarda como: <code class="bg-gray-200 px-1 rounded">job_carga_ventas.kjb</code></li>
                            </ol>

                            <h4 class="font-bold text-lg mt-4">Paso 2: Disenar el Flujo</h4>
                            <div class="bg-gray-100 p-4 rounded-lg">
                                <p class="text-sm text-gray-700 mb-3">Arrastra los siguientes componentes y conectalos:</p>
                                <div class="flex flex-wrap items-center justify-center gap-2 text-sm">
                                    <div class="bg-green-100 px-3 py-2 rounded">START</div>
                                    <span>‚Üí</span>
                                    <div class="bg-amber-100 px-3 py-2 rounded">Create folder</div>
                                    <span>‚Üí</span>
                                    <div class="bg-cyan-100 px-3 py-2 rounded">Transformation</div>
                                    <span>‚Üí</span>
                                    <div class="bg-purple-100 px-3 py-2 rounded">Evaluate</div>
                                </div>
                                <div class="flex justify-center gap-8 mt-3">
                                    <div class="text-center">
                                        <div class="text-green-600">‚Üì Exito</div>
                                        <div class="bg-green-100 px-3 py-2 rounded mt-1">Success</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-red-600">‚Üì Error</div>
                                        <div class="bg-red-100 px-3 py-2 rounded mt-1">Mail (Error)</div>
                                        <span>‚Üí</span>
                                        <div class="bg-red-100 px-3 py-2 rounded mt-1 inline-block">Abort</div>
                                    </div>
                                </div>
                            </div>

                            <h4 class="font-bold text-lg mt-4">Paso 3: Configurar Componentes</h4>

                            <div class="bg-gray-100 p-4 rounded-lg mt-2 text-sm">
                                <h5 class="font-bold mb-2">Create folder</h5>
                                <ul class="text-gray-700 space-y-1">
                                    <li>Folder name: <code class="bg-gray-200 px-1">logs/\${Internal.Job.Timestamp.Date}</code></li>
                                </ul>
                            </div>

                            <div class="bg-gray-100 p-4 rounded-lg mt-2 text-sm">
                                <h5 class="font-bold mb-2">Transformation</h5>
                                <ul class="text-gray-700 space-y-1">
                                    <li>Transformation: <code class="bg-gray-200 px-1">tr_farmacia_ventas.ktr</code></li>
                                </ul>
                            </div>

                            <div class="bg-gray-100 p-4 rounded-lg mt-2 text-sm">
                                <h5 class="font-bold mb-2">Mail (opcional)</h5>
                                <ul class="text-gray-700 space-y-1">
                                    <li>Destination: tu-email@ejemplo.com</li>
                                    <li>Subject: [ETL] Carga de ventas - \${Internal.Job.Timestamp.Date}</li>
                                </ul>
                            </div>

                            <h4 class="font-bold text-lg mt-4">Paso 4: Ejecutar Job</h4>
                            <p class="text-gray-700">
                                Ejecuta el job con F8 o el boton Run. Observa en el log como se ejecuta cada paso.
                            </p>
                        </div>
                    `
                },
                {
                    title: 'Verificar y Documentar',
                    duration: '10 min',
                    icon: '‚úÖ',
                    content: `
                        <div class="space-y-4">
                            <div class="bg-cyan-50 border-l-4 border-cyan-500 p-4">
                                <h4 class="font-bold text-cyan-800">Objetivo</h4>
                                <p class="text-gray-700">Verificar los datos cargados y documentar el proceso ETL.</p>
                            </div>

                            <h4 class="font-bold text-lg">Paso 1: Verificar en Base de Datos</h4>
                            <div class="bg-gray-800 text-green-400 p-4 rounded-lg font-mono text-sm overflow-x-auto">
<pre>-- Contar registros por sucursal
SELECT
    sucursal,
    COUNT(*) as registros,
    SUM(total_linea) as total_ventas
FROM staging.stg_ventas_farmacia
GROUP BY sucursal
ORDER BY sucursal;

-- Verificar fechas
SELECT
    MIN(fecha_venta) as fecha_min,
    MAX(fecha_venta) as fecha_max
FROM staging.stg_ventas_farmacia;

-- Top 5 productos mas vendidos
SELECT
    codigo_producto,
    nombre_producto,
    SUM(cantidad) as total_cantidad
FROM staging.stg_ventas_farmacia
GROUP BY codigo_producto, nombre_producto
ORDER BY total_cantidad DESC
LIMIT 5;</pre>
                            </div>

                            <h4 class="font-bold text-lg mt-4">Paso 2: Documentar el Proceso</h4>
                            <div class="bg-gray-100 p-4 rounded-lg">
                                <h5 class="font-bold mb-2">Documentacion del ETL</h5>
                                <table class="w-full text-sm">
                                    <tr class="border-b"><td class="font-medium py-1">Nombre:</td><td>ETL Consolidacion Ventas Farmacia</td></tr>
                                    <tr class="border-b"><td class="font-medium py-1">Fuentes:</td><td>3 archivos CSV (sucursales A, B, C)</td></tr>
                                    <tr class="border-b"><td class="font-medium py-1">Destino:</td><td>staging.stg_ventas_farmacia</td></tr>
                                    <tr class="border-b"><td class="font-medium py-1">Frecuencia:</td><td>Diaria, 6:00 AM</td></tr>
                                    <tr class="border-b"><td class="font-medium py-1">Transformaciones:</td><td>
                                        <ul class="list-disc list-inside">
                                            <li>Estandarizacion de nombres de columnas</li>
                                            <li>Conversion de formatos de fecha</li>
                                            <li>Normalizacion de mayusculas</li>
                                            <li>Adicion de identificador de sucursal</li>
                                        </ul>
                                    </td></tr>
                                </table>
                            </div>

                            <h4 class="font-bold text-lg mt-4">Paso 3: Captura de Pantalla</h4>
                            <p class="text-gray-700">
                                Toma capturas de:
                            </p>
                            <ol class="list-decimal list-inside space-y-1 text-gray-700">
                                <li>Tu transformacion completa en Spoon</li>
                                <li>Tu job completo</li>
                                <li>El log de ejecucion exitosa</li>
                                <li>Los resultados de las queries de verificacion</li>
                            </ol>

                            <div class="bg-green-50 border border-green-200 p-4 rounded-lg mt-4">
                                <h4 class="font-bold text-green-800">Entregable del Laboratorio</h4>
                                <ul class="text-sm text-gray-700 space-y-1 mt-2">
                                    <li>‚úì Archivo tr_farmacia_ventas.ktr</li>
                                    <li>‚úì Archivo job_carga_ventas.kjb</li>
                                    <li>‚úì Capturas de pantalla</li>
                                    <li>‚úì Script SQL de verificacion con resultados</li>
                                </ul>
                            </div>
                        </div>
                    `
                }
            ];

            const markComplete = (stepIndex) => {
                if (!completedSteps.includes(stepIndex)) {
                    setCompletedSteps([...completedSteps, stepIndex]);
                }
                if (stepIndex < labSteps.length - 1) {
                    setCurrentStep(stepIndex + 1);
                }
            };

            const progress = (completedSteps.length / labSteps.length) * 100;

            return (
                <div className="max-w-5xl mx-auto p-6">
                    {/* Header */}
                    <div className="bg-gradient-to-r from-emerald-600 to-teal-600 text-white p-6 rounded-xl shadow-lg mb-6">
                        <div className="flex items-center gap-2 text-emerald-100 mb-2">
                            <a href="./" className="hover:text-white">‚Üê Volver al simulador</a>
                        </div>
                        <h1 className="text-3xl font-bold mb-2">Laboratorio: ETL con Pentaho</h1>
                        <p className="text-emerald-100">Caso FarmaciaSalud Panama - Consolidacion de Ventas</p>

                        {/* Progress bar */}
                        <div className="mt-4">
                            <div className="flex justify-between text-sm mb-1">
                                <span>Progreso</span>
                                <span>{completedSteps.length} de {labSteps.length} pasos</span>
                            </div>
                            <div className="w-full bg-emerald-800 rounded-full h-2">
                                <div
                                    className="bg-white rounded-full h-2 transition-all duration-300"
                                    style={{ width: `${progress}%` }}
                                />
                            </div>
                        </div>
                    </div>

                    <div className="grid md:grid-cols-4 gap-6">
                        {/* Sidebar - Steps */}
                        <div className="md:col-span-1 space-y-2">
                            {labSteps.map((step, index) => (
                                <button
                                    key={index}
                                    onClick={() => setCurrentStep(index)}
                                    className={`w-full text-left p-3 rounded-lg transition-all ${
                                        currentStep === index
                                            ? 'bg-emerald-100 border-2 border-emerald-500'
                                            : completedSteps.includes(index)
                                            ? 'bg-green-50 border border-green-300'
                                            : 'bg-white border border-gray-200 hover:border-emerald-300'
                                    }`}
                                >
                                    <div className="flex items-center gap-2">
                                        {completedSteps.includes(index) ? (
                                            <span className="text-green-500">‚úì</span>
                                        ) : (
                                            <span>{step.icon}</span>
                                        )}
                                        <span className="text-sm font-medium">{step.title}</span>
                                    </div>
                                    <div className="text-xs text-gray-500 ml-6">{step.duration}</div>
                                </button>
                            ))}
                        </div>

                        {/* Main content */}
                        <div className="md:col-span-3">
                            <div className="bg-white rounded-xl shadow-lg p-6">
                                <div className="flex items-center justify-between mb-4">
                                    <h2 className="text-2xl font-bold text-gray-800 flex items-center gap-2">
                                        <span>{labSteps[currentStep].icon}</span>
                                        {labSteps[currentStep].title}
                                    </h2>
                                    <span className="text-sm text-gray-500">
                                        {labSteps[currentStep].duration}
                                    </span>
                                </div>

                                <div
                                    dangerouslySetInnerHTML={{ __html: labSteps[currentStep].content }}
                                />

                                <div className="flex justify-between mt-6 pt-4 border-t">
                                    <button
                                        onClick={() => setCurrentStep(Math.max(0, currentStep - 1))}
                                        disabled={currentStep === 0}
                                        className="px-4 py-2 text-gray-600 disabled:opacity-50"
                                    >
                                        ‚Üê Anterior
                                    </button>

                                    <button
                                        onClick={() => markComplete(currentStep)}
                                        className={`px-6 py-2 rounded-lg font-medium transition-colors ${
                                            completedSteps.includes(currentStep)
                                                ? 'bg-green-100 text-green-700'
                                                : 'bg-emerald-600 text-white hover:bg-emerald-700'
                                        }`}
                                    >
                                        {completedSteps.includes(currentStep)
                                            ? '‚úì Completado'
                                            : currentStep === labSteps.length - 1
                                            ? 'Finalizar'
                                            : 'Marcar como completado ‚Üí'
                                        }
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    {/* Footer */}
                    <div className="mt-8 text-center text-gray-500 text-sm">
                        <p>Laboratorio Sesion 06 - Taller de Tecnologia Aplicada</p>
                        <p>ADEN University - Cuatrimestre I 2026</p>
                    </div>
                </div>
            );
        }

        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
